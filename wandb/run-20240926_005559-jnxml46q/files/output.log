/home/krm-demo/miniconda3/envs/rl_tuto/lib/python3.8/site-packages/gym/utils/passive_env_checker.py:233: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not isinstance(terminated, (bool, np.bool8)):
actor_critic.py:48: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:278.)
  s_batch, a_batch, r_batch, s_prime_batch, done_batch = torch.tensor(s_lst, dtype=torch.float), torch.tensor(a_lst), \
# of episode :20, avg score : 20.9
# of episode :40, avg score : 17.1
# of episode :60, avg score : 20.2
# of episode :80, avg score : 21.2
# of episode :100, avg score : 20.7
# of episode :120, avg score : 22.9
# of episode :140, avg score : 26.9
# of episode :160, avg score : 29.3
# of episode :180, avg score : 25.1
# of episode :200, avg score : 24.5
# of episode :220, avg score : 30.6
# of episode :240, avg score : 45.4
# of episode :260, avg score : 42.5
# of episode :280, avg score : 38.5
# of episode :300, avg score : 49.2
# of episode :320, avg score : 56.8
# of episode :340, avg score : 67.5
# of episode :360, avg score : 61.1
# of episode :380, avg score : 59.1
# of episode :400, avg score : 54.7
# of episode :420, avg score : 92.4
# of episode :440, avg score : 114.8
# of episode :460, avg score : 167.2
# of episode :480, avg score : 169.7
# of episode :500, avg score : 172.9
# of episode :520, avg score : 187.1
# of episode :540, avg score : 207.6
# of episode :560, avg score : 179.2
# of episode :580, avg score : 133.2
# of episode :600, avg score : 150.5
# of episode :620, avg score : 133.2
# of episode :640, avg score : 138.5
# of episode :660, avg score : 142.7
# of episode :680, avg score : 147.9
# of episode :700, avg score : 265.6
# of episode :720, avg score : 222.5
/home/krm-demo/miniconda3/envs/rl_tuto/lib/python3.8/site-packages/gym/envs/classic_control/cartpole.py:211: UserWarning: [33mWARN: You are calling render method without specifying any render mode. You can specify the render_mode at initialization, e.g. gym("CartPole-v1", render_mode="rgb_array")[0m
  gym.logger.warn(
# of episode :740, avg score : 333.4
# of episode :760, avg score : 388.9
# of episode :780, avg score : 218.4
# of episode :800, avg score : 366.2
# of episode :820, avg score : 441.6
# of episode :840, avg score : 423.9
# of episode :860, avg score : 392.6
# of episode :880, avg score : 231.9
# of episode :900, avg score : 241.7
# of episode :920, avg score : 235.6
# of episode :940, avg score : 278.8
# of episode :960, avg score : 514.8
# of episode :980, avg score : 512.9
# of episode :1000, avg score : 472.9
# of episode :1020, avg score : 209.0
# of episode :1040, avg score : 209.1
# of episode :1060, avg score : 237.3
# of episode :1080, avg score : 246.2
# of episode :1100, avg score : 283.6
# of episode :1120, avg score : 298.9
# of episode :1140, avg score : 486.1
# of episode :1160, avg score : 712.1
# of episode :1180, avg score : 601.8
# of episode :1200, avg score : 378.3
# of episode :1220, avg score : 487.6
# of episode :1240, avg score : 502.7
# of episode :1260, avg score : 273.6
# of episode :1280, avg score : 515.8
# of episode :1300, avg score : 438.0
# of episode :1320, avg score : 699.0
# of episode :1340, avg score : 416.9
# of episode :1360, avg score : 699.9
# of episode :1380, avg score : 332.8
# of episode :1400, avg score : 370.2
# of episode :1420, avg score : 861.5
# of episode :1440, avg score : 2508.8
# of episode :1460, avg score : 2153.2
# of episode :1480, avg score : 164.1
# of episode :1500, avg score : 234.6
# of episode :1520, avg score : 1168.2
# of episode :1540, avg score : 453.2
# of episode :1560, avg score : 345.1
# of episode :1580, avg score : 307.6
# of episode :1600, avg score : 329.6
# of episode :1620, avg score : 319.5
# of episode :1640, avg score : 395.9
# of episode :1660, avg score : 1857.8
# of episode :1680, avg score : 674.7
# of episode :1700, avg score : 769.3
# of episode :1720, avg score : 170.8
Traceback (most recent call last):
  File "actor_critic.py", line 112, in <module>
    main()
  File "actor_critic.py", line 90, in main
    a = m.sample().item()
  File "/home/krm-demo/miniconda3/envs/rl_tuto/lib/python3.8/site-packages/torch/distributions/categorical.py", line 132, in sample
    probs_2d = self.probs.reshape(-1, self._num_events)
KeyboardInterrupt
